shortCut: w
description: Open PowerShell terminal
scopes:
  - pods
  - containers
command: bash
background: false
args:
  - -c
  - >
    if [ -n "$POD" ]; then
      _pod=$POD;
      _container="--container $NAME";
      _title="$_pod/$NAME";
    else
      _pod=$NAME;
      _title=$NAME;
    fi;

    SHELL_CHOICE=$(whiptail --title "$_title" --menu "Choose" 15 60 5
    "bash" "Bash shell (bash)"
    "cmd" "Command Interpreter (cmd.exe)"
    "powershell" "Windows PowerShell (powershell.exe)"
    "pwsh" "PowerShell (pwsh)"
    "sh" "default shell (sh)"
    3>&1 1>&2 2>&3);

    EXIT_STATUS=$?;
    if [ $EXIT_STATUS -ne 0 ]; then
      echo "Shell selection cancelled.";
      exit 0;
    fi;

    kubectl
    exec
    $_pod
    --context $CONTEXT
    $_container
    --kubeconfig $KUBECONFIG
    --namespace $NAMESPACE
    --stdin=true
    --tty=true
    --
    $SHELL_CHOICE
